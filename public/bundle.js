(()=>{"use strict";var n={56:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},72:n=>{var e=[];function t(n){for(var t=-1,o=0;o<e.length;o++)if(e[o].identifier===n){t=o;break}return t}function o(n,o){for(var a={},r=[],i=0;i<n.length;i++){var d=n[i],l=o.base?d[0]+o.base:d[0],c=a[l]||0,m="".concat(l," ").concat(c);a[l]=c+1;var p=t(m),g={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==p)e[p].references++,e[p].updater(g);else{var h=s(g,o);o.byIndex=i,e.splice(i,0,{identifier:m,updater:h,references:1})}r.push(m)}return r}function s(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,s){var a=o(n=n||[],s=s||{});return function(n){n=n||[];for(var r=0;r<a.length;r++){var i=t(a[r]);e[i].references--}for(var d=o(n,s),l=0;l<a.length;l++){var c=t(a[l]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}a=d}}},113:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},314:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t="",o=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),o&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),o&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t}).join("")},e.i=function(n,t,o,s,a){"string"==typeof n&&(n=[[null,n,void 0]]);var r={};if(o)for(var i=0;i<this.length;i++){var d=this[i][0];null!=d&&(r[d]=!0)}for(var l=0;l<n.length;l++){var c=[].concat(n[l]);o&&r[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),e.push(c))}},e}},365:(n,e,t)=>{t.d(e,{A:()=>i});var o=t(601),s=t.n(o),a=t(314),r=t.n(a)()(s());r.push([n.id,"/* Reset and Base Styles */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    line-height: 1.6;\n    color: #333;\n    background-color: #f8fafc;\n}\n\n/* Utility Classes */\n.hidden {\n    display: none !important;\n}\n\n/* Header */\n.header {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 1rem 0;\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 0 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.logo {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.logo i {\n    font-size: 2rem;\n    color: #ffd700;\n}\n\n.logo h1 {\n    font-size: 1.5rem;\n    font-weight: 600;\n}\n\n.header-actions {\n    display: flex;\n    gap: 1rem;\n}\n\n/* Main Content */\n.main-content {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n}\n\n/* Sections */\n.section {\n    background: white;\n    border-radius: 12px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n    border: 1px solid #e2e8f0;\n}\n\n.section-header {\n    margin-bottom: 2rem;\n    text-align: center;\n}\n\n.section-header h2 {\n    color: #1e293b;\n    font-size: 1.75rem;\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n}\n\n.section-header p {\n    color: #64748b;\n    font-size: 1rem;\n}\n\n/* Worker Selection */\n.worker-selection {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 1.5rem;\n    max-width: 400px;\n    margin: 0 auto;\n}\n\n/* Form Elements */\n.select-input, .input-field {\n    width: 100%;\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 1rem;\n    transition: all 0.2s ease;\n    background: white;\n}\n\n.select-input:focus, .input-field:focus {\n    outline: none;\n    border-color: #667eea;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.scanner-group {\n    display: flex;\n    gap: 0.5rem;\n    width: 100%;\n}\n\n.scanner-group .input-field {\n    flex: 1;\n}\n\n/* Buttons */\n.btn {\n    padding: 0.75rem 1.5rem;\n    border: none;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    text-decoration: none;\n    min-height: 48px;\n}\n\n.btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n}\n\n.btn-secondary {\n    background: #64748b;\n    color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n    background: #475569;\n    transform: translateY(-1px);\n}\n\n.btn-success {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n    color: white;\n}\n\n.btn-success:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);\n}\n\n.btn-warning {\n    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);\n    color: white;\n}\n\n.btn-warning:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);\n}\n\n.btn-danger {\n    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n    color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);\n}\n\n/* Installation Session */\n.session-info {\n    display: flex;\n    justify-content: center;\n    gap: 2rem;\n    margin-top: 1rem;\n    flex-wrap: wrap;\n}\n\n.session-info span {\n    background: #f1f5f9;\n    padding: 0.5rem 1rem;\n    border-radius: 20px;\n    font-size: 0.875rem;\n    color: #475569;\n    font-weight: 500;\n}\n\n/* Scanner Section */\n.scanner-section {\n    background: #f8fafc;\n    padding: 2rem;\n    border-radius: 8px;\n    margin-bottom: 2rem;\n}\n\n.scanner-input label {\n    display: block;\n    margin-bottom: 1rem;\n    font-weight: 500;\n    color: #1e293b;\n    text-align: center;\n}\n\n/* Component Display */\n.component-display {\n    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n    border: 2px solid #0ea5e9;\n    border-radius: 12px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n}\n\n.component-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n    flex-wrap: wrap;\n    gap: 1rem;\n}\n\n.component-header h3 {\n    color: #0c4a6e;\n    font-size: 1.5rem;\n    font-weight: 600;\n}\n\n.part-number {\n    background: #0ea5e9;\n    color: white;\n    padding: 0.5rem 1rem;\n    border-radius: 20px;\n    font-size: 0.875rem;\n    font-weight: 500;\n}\n\n.component-details {\n    margin-bottom: 1.5rem;\n}\n\n.component-details p {\n    color: #0c4a6e;\n    margin-bottom: 1rem;\n    line-height: 1.6;\n}\n\n.sequence-info {\n    display: flex;\n    justify-content: center;\n}\n\n.sequence-badge {\n    background: #10b981;\n    color: white;\n    padding: 0.5rem 1rem;\n    border-radius: 20px;\n    font-size: 0.875rem;\n    font-weight: 500;\n}\n\n.installation-guide {\n    background: white;\n    border-radius: 8px;\n    padding: 1.5rem;\n}\n\n.installation-guide h4 {\n    color: #1e293b;\n    margin-bottom: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.guide-steps {\n    color: #374151;\n    line-height: 1.8;\n    white-space: pre-line;\n}\n\n.install-actions {\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid #e2e8f0;\n    text-align: center;\n}\n\n.install-actions .btn {\n    font-size: 1rem;\n    padding: 0.75rem 1.5rem;\n}\n\n/* Error Display */\n.error-display {\n    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n    border: 2px solid #ef4444;\n    border-radius: 12px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    text-align: center;\n}\n\n.error-content i {\n    font-size: 3rem;\n    color: #ef4444;\n    margin-bottom: 1rem;\n}\n\n.error-content h3 {\n    color: #991b1b;\n    margin-bottom: 1rem;\n    font-size: 1.5rem;\n}\n\n.error-content p {\n    color: #7f1d1d;\n    margin-bottom: 1.5rem;\n    font-size: 1.1rem;\n    line-height: 1.6;\n}\n\n.error-actions {\n    display: flex;\n    justify-content: center;\n}\n\n/* Demo Components Hint */\n.demo-hint {\n    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\n    border: 2px solid #f59e0b;\n    border-radius: 16px;\n    padding: 20px;\n    margin: 20px 0;\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n}\n\n.demo-hint h4 {\n    color: #92400e;\n    margin: 0 0 16px 0;\n    font-size: 1.1em;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.demo-components {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 12px;\n    margin-bottom: 16px;\n}\n\n.demo-component {\n    background: rgba(255, 255, 255, 0.8);\n    padding: 12px;\n    border-radius: 8px;\n    border: 1px solid #f59e0b;\n    font-size: 0.9em;\n    color: #92400e;\n    text-align: center;\n    transition: all 0.2s ease;\n}\n\n.demo-component:hover {\n    background: rgba(255, 255, 255, 1);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);\n}\n\n.demo-component strong {\n    color: #d97706;\n    font-weight: 600;\n}\n\n.demo-note {\n    background: rgba(255, 255, 255, 0.9);\n    padding: 12px;\n    border-radius: 8px;\n    border-left: 4px solid #3b82f6;\n    margin: 0;\n    font-size: 0.9em;\n    color: #1e40af;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.demo-note i {\n    color: #3b82f6;\n    font-size: 1.1em;\n}\n\n/* Session Progress */\n.session-progress {\n    background: #f8fafc;\n    padding: 1.5rem;\n    border-radius: 8px;\n    margin-bottom: 2rem;\n}\n\n.session-progress h4 {\n    color: #1e293b;\n    margin-bottom: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.progress-bar {\n    width: 100%;\n    height: 12px;\n    background: #e2e8f0;\n    border-radius: 6px;\n    overflow: hidden;\n    margin-bottom: 1rem;\n}\n\n.progress-fill {\n    height: 100%;\n    background: linear-gradient(90deg, #10b981 0%, #059669 100%);\n    width: 0%;\n    transition: width 0.3s ease;\n}\n\n.progress-stats {\n    display: flex;\n    justify-content: space-between;\n    color: #64748b;\n    font-weight: 500;\n}\n\n/* Session Actions */\n.session-actions {\n    display: flex;\n    justify-content: center;\n    gap: 1rem;\n    flex-wrap: wrap;\n}\n\n/* Modals */\n.modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.modal-content {\n    background: white;\n    border-radius: 12px;\n    max-width: 800px;\n    width: 90%;\n    max-height: 90vh;\n    overflow-y: auto;\n    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n}\n\n.modal-header {\n    padding: 1.5rem 2rem;\n    border-bottom: 1px solid #e2e8f0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.modal-header h2 {\n    color: #1e293b;\n    font-size: 1.5rem;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.modal-close {\n    background: none;\n    border: none;\n    font-size: 1.5rem;\n    cursor: pointer;\n    color: #64748b;\n    padding: 0.5rem;\n    border-radius: 4px;\n    transition: all 0.2s ease;\n}\n\n.modal-close:hover {\n    background: #f1f5f9;\n    color: #1e293b;\n}\n\n.modal-body {\n    padding: 2rem;\n}\n\n/* Loading Overlay */\n.loading-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(255, 255, 255, 0.9);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 2000;\n}\n\n.loading-spinner {\n    text-align: center;\n    color: #667eea;\n}\n\n.loading-spinner i {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n}\n\n.loading-spinner p {\n    font-size: 1.1rem;\n    font-weight: 500;\n}\n\n/* Toast Notifications */\n.toast-container {\n    position: fixed;\n    top: 2rem;\n    right: 2rem;\n    z-index: 3000;\n}\n\n.toast {\n    background: white;\n    border-radius: 8px;\n    padding: 1rem 1.5rem;\n    margin-bottom: 1rem;\n    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n    border-left: 4px solid;\n    animation: slideIn 0.3s ease;\n}\n\n.toast.success {\n    border-left-color: #10b981;\n}\n\n.toast.error {\n    border-left-color: #ef4444;\n}\n\n.toast.warning {\n    border-left-color: #f59e0b;\n}\n\n.toast.info {\n    border-left-color: #3b82f6;\n}\n\n@keyframes slideIn {\n    from {\n        transform: translateX(100%);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n/* Statistics and Sessions Content */\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n    margin-bottom: 2rem;\n}\n\n.stat-card {\n    background: #f8fafc;\n    padding: 1.5rem;\n    border-radius: 8px;\n    text-align: center;\n    border: 1px solid #e2e8f0;\n}\n\n.stat-card h3 {\n    color: #1e293b;\n    font-size: 2rem;\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n}\n\n.stat-card p {\n    color: #64748b;\n    font-size: 0.875rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.sessions-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 1rem;\n}\n\n.sessions-table th,\n.sessions-table td {\n    padding: 0.75rem;\n    text-align: left;\n    border-bottom: 1px solid #e2e8f0;\n}\n\n.sessions-table th {\n    background: #f8fafc;\n    font-weight: 600;\n    color: #1e293b;\n}\n\n.sessions-table tr:hover {\n    background: #f8fafc;\n}\n\n.status-badge {\n    padding: 0.25rem 0.75rem;\n    border-radius: 12px;\n    font-size: 0.75rem;\n    font-weight: 500;\n    text-transform: uppercase;\n}\n\n.status-badge.completed {\n    background: #dcfce7;\n    color: #166534;\n}\n\n.status-badge.in_progress {\n    background: #dbeafe;\n    color: #1e40af;\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    .header-content {\n        flex-direction: column;\n        gap: 1rem;\n        text-align: center;\n    }\n\n    .logo h1 {\n        font-size: 1.25rem;\n    }\n\n    .main-content {\n        padding: 1rem;\n    }\n\n    .section {\n        padding: 1.5rem;\n    }\n\n    .session-info {\n        flex-direction: column;\n        gap: 1rem;\n    }\n\n    .scanner-group {\n        flex-direction: column;\n    }\n\n    .session-actions {\n        flex-direction: column;\n    }\n\n    .modal-content {\n        width: 95%;\n        margin: 1rem;\n    }\n\n    .modal-header,\n    .modal-body {\n        padding: 1rem;\n    }\n\n    .stats-grid {\n        grid-template-columns: 1fr;\n    }\n\n    .sessions-table {\n        font-size: 0.875rem;\n    }\n\n    .sessions-table th,\n    .sessions-table td {\n        padding: 0.5rem;\n    }\n}\n\n@media (max-width: 480px) {\n    .header-actions {\n        flex-direction: column;\n        width: 100%;\n    }\n\n    .header-actions .btn {\n        width: 100%;\n    }\n\n    .component-header {\n        flex-direction: column;\n        text-align: center;\n    }\n\n    .progress-stats {\n        flex-direction: column;\n        gap: 0.5rem;\n        text-align: center;\n    }\n}\n",""]);const i=r},540:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},601:n=>{n.exports=function(n){return n[1]}},659:n=>{var e={};n.exports=function(n,t){var o=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var s=void 0!==t.layer;s&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,s&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(o,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}}},e={};function t(o){var s=e[o];if(void 0!==s)return s.exports;var a=e[o]={id:o,exports:{}};return n[o](a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0;var o=t(72),s=t.n(o),a=t(825),r=t.n(a),i=t(659),d=t.n(i),l=t(56),c=t.n(l),m=t(540),p=t.n(m),g=t(113),h=t.n(g),u=t(365),f={};f.styleTagTransform=h(),f.setAttributes=c(),f.insert=d().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=p(),s()(u.A,f),u.A&&u.A.locals&&u.A.locals;const b="https://your-render-backend-name.onrender.com";class y{constructor(){this.currentSession=null,this.currentWorker=null,this.components=[],this.workers=[],this.sessionLogs=[],this.initializeEventListeners(),this.loadInitialData()}initializeEventListeners(){document.getElementById("workerSelect").addEventListener("change",n=>{this.handleWorkerSelection(n.target.value)}),document.getElementById("startSessionBtn").addEventListener("click",()=>{this.startInstallationSession()}),document.getElementById("scanBtn").addEventListener("click",()=>{this.scanComponent()}),document.getElementById("componentScanner").addEventListener("keypress",n=>{"Enter"===n.key&&this.scanComponent()}),document.getElementById("installCompleteBtn").addEventListener("click",()=>{this.markInstallationComplete()}),document.getElementById("completeSessionBtn").addEventListener("click",()=>{this.completeSession()}),document.getElementById("resetSessionBtn").addEventListener("click",()=>{this.resetSession()}),document.getElementById("acknowledgeErrorBtn").addEventListener("click",()=>{this.acknowledgeError()}),document.getElementById("viewStatsBtn").addEventListener("click",()=>{this.showStatistics()}),document.getElementById("viewSessionsBtn").addEventListener("click",()=>{this.showAllSessions()}),document.getElementById("resetDbBtn").addEventListener("click",()=>{this.resetDatabase()}),document.querySelectorAll(".modal-close").forEach(n=>{n.addEventListener("click",n=>{this.closeModal(n.target.closest(".modal"))})}),document.querySelectorAll(".modal").forEach(n=>{n.addEventListener("click",e=>{e.target===n&&this.closeModal(n)})})}async loadInitialData(){try{this.showLoading();const[n,e]=await Promise.all([fetch(`${b}/api/workers`),fetch(`${b}/api/components`)]);if(!n.ok||!e.ok)throw new Error("Failed to load initial data");this.workers=await n.json(),this.components=await e.json(),this.populateWorkerSelect(),this.hideLoading()}catch(n){console.error("Error loading initial data:",n),this.showToast("Error loading initial data","error"),this.hideLoading()}}populateWorkerSelect(){const n=document.getElementById("workerSelect");n.innerHTML='<option value="">Select a worker...</option>',this.workers.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=`${e.name} (${e.employee_id})`,n.appendChild(t)})}handleWorkerSelection(n){document.getElementById("startSessionBtn").disabled=!n,n&&(this.currentWorker=this.workers.find(e=>e.id===n))}async startInstallationSession(){if(this.currentWorker)try{this.showLoading();const n=await fetch(`${b}/api/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({worker_id:this.currentWorker.id})});if(!n.ok)throw new Error("Failed to start session");this.currentSession=await n.json(),this.sessionLogs=[],this.showInstallationSession(),this.updateSessionInfo(),this.showToast("Sesi pemasangan bermula dengan jayanya","success")}catch(n){console.error("Error starting session:",n),this.showToast("Error starting session","error")}finally{this.hideLoading()}else this.showToast("Sila pilih pekerja terlebih dahulu","error")}showInstallationSession(){document.getElementById("workerSelection").classList.add("hidden"),document.getElementById("installationSession").classList.remove("hidden"),document.getElementById("componentScanner").focus()}updateSessionInfo(){this.currentSession&&this.currentWorker&&(document.getElementById("sessionWorker").textContent=`Worker: ${this.currentWorker.name}`,document.getElementById("sessionTime").textContent=`Started: ${this.formatTime(this.currentSession.start_time)}`,document.getElementById("sessionStatus").textContent=`Status: ${this.currentSession.status}`)}async scanComponent(){const n=document.getElementById("componentScanner").value.trim();if(n)if(this.currentSession){this.removeWarningMessage();try{this.showLoading();const e=await fetch(`${b}/api/sessions/${this.currentSession.session_id}/scan`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({partNumber:n})}),t=await e.json();if(!e.ok){if(t.isAlreadyInstalled)this.showToast("Komponen sudah dipasang. Sila periksa semula.","warning"),this.displayAlreadyInstalledComponent(t.component),this.disableScannerForAlreadyInstalled(),this.sessionLogs.push({component:t.component,scanTime:(new Date).toISOString(),isSequenceCorrect:!1,errorMessage:"Komponen sudah dipasang",isRepeatedScan:!0}),this.updateSessionStats();else if(t.isSequenceError)this.showToast(`Komponen ini sudah diimbas dengan ralat urutan: ${t.errorMessage}`,"error"),this.displayError(t.errorMessage,0),this.sessionLogs.push({component:t.component,scanTime:(new Date).toISOString(),isSequenceCorrect:!1,errorMessage:t.errorMessage,isRepeatedScan:!0}),this.updateSessionStats(),document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0,setTimeout(()=>{document.getElementById("componentScanner").disabled=!1,document.getElementById("scanBtn").disabled=!1},3e3);else{if(!t.isDuplicate)throw new Error(t.error||"Scan failed");this.showToast("Component already scanned","warning"),this.displayComponent(t.component,!0),this.sessionLogs.push({component:t.component,scanTime:(new Date).toISOString(),isSequenceCorrect:!1,errorMessage:"Komponen sudah diimbas",isRepeatedScan:!0}),this.updateSessionStats()}return}if(this.sessionLogs.push({component:t.component,scanTime:t.scanTime,isSequenceCorrect:t.isSequenceCorrect,errorMessage:t.errorMessage}),t.isBlocked)return this.displayBlockedError(t.errorMessage,t.wrongScansCount),void this.updateSessionStats();t.isSequenceCorrect?(this.hideError(),this.updateSessionStats(),t.showInstallationGuide&&(this.currentComponent=t.component,this.displayComponent(t.component,!1),this.showToast(`Komponen ${t.component.name} diimbas dengan jayanya. Selesaikan pemasangan sebelum mengimbas komponen seterusnya.`,"success"),document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0)):(this.displayError(t.errorMessage,t.wrongScansCount),this.updateSessionStats(),this.hideComponentDisplay(),document.getElementById("componentScanner").value="",this.showToast(`Urutan salah: ${t.errorMessage}`,"error"),t.canScan||(document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0)),document.getElementById("componentScanner").value="",document.getElementById("componentScanner").focus()}catch(n){console.error("Error scanning component:",n),this.showToast(`Error scanning component: ${n.message}`,"error")}finally{this.hideLoading()}}else this.showToast("No active session","error");else this.showToast("Sila masukkan nombor bahagian","warning")}displayComponent(n,e=!1){const t=document.getElementById("currentComponent");document.getElementById("componentName").textContent=n.name,document.getElementById("componentPartNumber").textContent=n.part_number,document.getElementById("componentDescription").textContent=n.description,document.getElementById("sequenceOrder").textContent=n.sequence_order,document.getElementById("guideSteps").textContent=n.installation_guide,t.classList.remove("hidden"),document.getElementById("installCompleteBtn").style.display="block",e?(t.style.borderColor="#f59e0b",t.style.background="linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)"):(t.style.borderColor="#0ea5e9",t.style.background="linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)")}displayAlreadyInstalledComponent(n){const e=document.getElementById("currentComponent");document.getElementById("componentName").textContent=n.name,document.getElementById("componentPartNumber").textContent=n.part_number,document.getElementById("componentDescription").textContent=n.description,document.getElementById("sequenceOrder").textContent=n.sequence_order,document.getElementById("guideSteps").innerHTML='\n            <div style="text-align: center; padding: 20px; color: #dc2626;">\n                <i class="fas fa-exclamation-triangle" style="font-size: 2em; margin-bottom: 10px;"></i>\n                <h4 style="color: #dc2626; margin: 0;">Komponen Sudah Dipasang!</h4>\n                <p style="margin: 10px 0; color: #6b7280;">\n                    Komponen ini telah ditandakan sebagai dipasang dalam sesi ini.\n                    Sila periksa semula urutan pemasangan anda.\n                </p>\n            </div>\n        ',document.getElementById("installCompleteBtn").style.display="none",e.classList.remove("hidden"),e.style.borderColor="#dc2626",e.style.background="linear-gradient(135deg, #fef2f2 0%, #fecaca 100%)"}disableScannerForAlreadyInstalled(){const n=document.getElementById("componentScanner"),e=document.getElementById("scanBtn");n.disabled=!0,e.disabled=!0;const t=document.querySelector(".scanner-section");let o=t.querySelector(".already-installed-warning");o||(o=document.createElement("div"),o.className="already-installed-warning",o.innerHTML='\n                <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 12px; margin-top: 10px; text-align: center;">\n                    <i class="fas fa-exclamation-triangle" style="color: #dc2626; margin-right: 8px;"></i>\n                    <span style="color: #dc2626; font-weight: 500;">\n                        Anda telah mengimbas komponen yang sudah dipasang. Sila periksa semula urutan pemasangan.\n                    </span>\n                    <div style="margin-top: 8px; font-size: 0.9em; color: #6b7280;">\n                        Scanner akan diaktifkan semula dalam 3 saat...\n                    </div>\n                </div>\n            ',t.appendChild(o)),setTimeout(()=>{n.disabled=!1,e.disabled=!1,o&&(o.innerHTML='\n                    <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 12px; margin-top: 10px; text-align: center;">\n                        <i class="fas fa-exclamation-triangle" style="color: #dc2626; margin-right: 8px;"></i>\n                        <span style="color: #dc2626; font-weight: 500;">\n                            Anda telah mengimbas komponen yang sudah dipasang. Sila periksa semula urutan pemasangan.\n                        </span>\n                        <div style="margin-top: 8px; font-size: 0.9em; color: #6b7280;">\n                            Scanner telah diaktifkan semula. Anda boleh terus mengimbas.\n                        </div>\n                    </div>\n                ')},3e3)}removeWarningMessage(){const n=document.querySelector(".already-installed-warning");n&&n.remove()}displayError(n,e){const t=document.getElementById("errorDisplay");document.getElementById("errorMessage").innerHTML=`\n            ${n}<br><br>\n            <strong>Imbasan salah dalam sesi ini: ${e}/3</strong><br>\n            ${e>=2?'<span style="color: #dc2626;">⚠️ AMARAN: Satu lagi imbasan salah akan menyekat sesi ini!</span>':""}\n        `,t.classList.remove("hidden"),document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0}displayBlockedError(n,e){const t=document.getElementById("errorDisplay");document.getElementById("errorMessage").innerHTML=`\n            <div style="color: #dc2626; font-size: 1.2em; margin-bottom: 1rem;">\n                🚫 <strong>SESI DISEKAT</strong> 🚫\n            </div>\n            ${n}<br><br>\n            <strong>Imbasan salah dalam sesi ini: ${e}/3</strong><br>\n            <span style="color: #dc2626; font-weight: bold;">\n                ⚠️ KRITIKAL: Anda telah melebihi had maksimum imbasan salah.<br>\n                Sesi ini kini disekat. Sila hubungi penyelia anda.\n            </span>\n        `,t.classList.remove("hidden"),document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0,document.getElementById("completeSessionBtn").disabled=!0,document.getElementById("resetSessionBtn").disabled=!0,this.showToast("SESI DISEKAT: Had maksimum imbasan salah terlampaui. Hubungi penyelia.","error")}hideError(){document.getElementById("errorDisplay").classList.add("hidden"),document.getElementById("componentScanner").disabled=!1,document.getElementById("scanBtn").disabled=!1}acknowledgeError(){if(this.sessionLogs.filter(n=>!n.isSequenceCorrect).length>=3)return void this.showToast("Sesi disekat. Hubungi penyelia anda untuk teruskan.","error");const n=this.sessionLogs.find(n=>"installed"===n.status);(n?n.component.sequence_order+1:1)<=this.components.length?(this.hideError(),this.showToast("Ralat diakui. Anda boleh terus mengimbas komponen seterusnya dalam urutan.","info")):this.showToast("Ralat diakui. Sila selesaikan pemasangan komponen semasa sebelum mengimbas komponen seterusnya.","warning")}hideComponentDisplay(){document.getElementById("currentComponent").classList.add("hidden")}async markInstallationComplete(){if(this.currentSession&&this.currentComponent)try{if(this.showLoading(),!(await fetch(`${b}/api/sessions/${this.currentSession.session_id}/install`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({componentId:this.currentComponent.id})})).ok)throw new Error("Failed to mark installation complete");const n=this.sessionLogs.findIndex(n=>n.component.id===this.currentComponent.id);-1!==n&&(this.sessionLogs[n].status="installed",this.sessionLogs[n].installTime=(new Date).toISOString()),this.hideComponentDisplay(),this.showToast(`Komponen ${this.currentComponent.name} ditandakan sebagai dipasang dengan jayanya`,"success"),this.updateSessionStats(),this.currentComponent=null,document.getElementById("componentScanner").disabled=!1,document.getElementById("scanBtn").disabled=!1}catch(n){console.error("Error marking installation complete:",n),this.showToast(`Error marking installation complete: ${n.message}`,"error")}finally{this.hideLoading()}else this.showToast("Tiada komponen aktif untuk ditandakan sebagai dipasang","error")}updateSessionStats(){this.sessionLogs.length;const n=this.sessionLogs.filter(n=>"installed"===n.status).length,e=this.sessionLogs.filter(n=>!n.isSequenceCorrect).length,t=n/this.components.length*100;document.getElementById("componentsCount").textContent=`${n}/${this.components.length}`,document.getElementById("errorsCount").textContent=`${e}/3`,document.getElementById("progressFill").style.width=`${t}%`;document.getElementById("progressFill").style.background=e>=3?"linear-gradient(90deg, #ef4444 0%, #dc2626 100%)":e>0?"linear-gradient(90deg, #f59e0b 0%, #d97706 100%)":"linear-gradient(90deg, #10b981 0%, #059669 100%)";const o=document.getElementById("errorsCount");e>=3?(o.style.color="#dc2626",o.style.fontWeight="bold"):e>=2?(o.style.color="#d97706",o.style.fontWeight="bold"):(o.style.color="#64748b",o.style.fontWeight="500"),e>=3&&this.checkAndBlockSession()}checkAndBlockSession(){const n=this.sessionLogs.filter(n=>!n.isSequenceCorrect).length;if(n>=3){this.displayBlockedError("Terlalu banyak ralat imbasan",n),document.getElementById("componentScanner").disabled=!0,document.getElementById("scanBtn").disabled=!0,document.getElementById("completeSessionBtn").disabled=!0,document.getElementById("resetSessionBtn").disabled=!0;const e=document.querySelector(".already-installed-warning");e&&e.remove()}}async completeSession(){if(this.currentSession)try{if(this.showLoading(),!(await fetch(`${b}/api/sessions/${this.currentSession.session_id}/complete`,{method:"PUT"})).ok)throw new Error("Failed to complete session");this.showToast("Sesi selesai dengan jayanya","success"),this.resetToWorkerSelection()}catch(n){console.error("Error completing session:",n),this.showToast("Error completing session","error")}finally{this.hideLoading()}else this.showToast("No active session","error")}resetSession(){this.sessionLogs.filter(n=>!n.isSequenceCorrect).length>=3?confirm("Sesi ini disekat kerana banyak imbasan salah. Menetapkan semula akan membersihkan sekatan dan membolehkan anda bermula semula. Teruskan?")&&this.resetToWorkerSelection():confirm("Adakah anda pasti mahu set semula sesi ini? Semua kemajuan akan hilang.")&&this.resetToWorkerSelection()}resetToWorkerSelection(){this.currentSession=null,this.currentWorker=null,this.currentComponent=null,this.sessionLogs=[],document.getElementById("installationSession").classList.add("hidden"),document.getElementById("workerSelection").classList.remove("hidden"),document.getElementById("currentComponent").classList.add("hidden"),document.getElementById("errorDisplay").classList.add("hidden"),document.getElementById("workerSelect").value="",document.getElementById("componentScanner").value="",document.getElementById("startSessionBtn").disabled=!0,document.getElementById("componentsCount").textContent="0/5",document.getElementById("errorsCount").textContent="0/3",document.getElementById("progressFill").style.width="0%",document.getElementById("componentScanner").disabled=!1,document.getElementById("scanBtn").disabled=!1;const n=document.querySelector(".already-installed-warning");n&&n.remove(),document.getElementById("installCompleteBtn").style.display="block"}async showStatistics(){try{this.showLoading();const n=await fetch(`${b}/api/sessions`);if(!n.ok)throw new Error("Failed to load sessions");const e=await n.json();this.displayStatistics(e),document.getElementById("statsModal").classList.remove("hidden")}catch(n){console.error("Error loading statistics:",n),this.showToast("Error loading statistics","error")}finally{this.hideLoading()}}displayStatistics(n){const e=document.getElementById("statsContent"),t=n.length,o=n.filter(n=>"completed"===n.status).length,s=n.reduce((n,e)=>n+e.components_installed,0),a=`\n            <div class="stats-grid">\n                <div class="stat-card">\n                    <h3>${t}</h3>\n                    <p>Jumlah Sesi</p>\n                </div>\n                <div class="stat-card">\n                    <h3>${o}</h3>\n                    <p>Sesi Selesai</p>\n                </div>\n                <div class="stat-card">\n                    <h3>${s}</h3>\n                    <p>Jumlah Komponen</p>\n                </div>\n                <div class="stat-card">\n                    <h3>${t>0?(s/t).toFixed(1):0}</h3>\n                    <p>Purata Komponen/Sesi</p>\n                </div>\n            </div>\n            \n            <h3>Sesi Terkini</h3>\n            <div class="sessions-table-container">\n                <table class="sessions-table">\n                    <thead>\n                                                 <tr>\n                             <th>Pekerja</th>\n                             <th>Masa Mula</th>\n                             <th>Status</th>\n                             <th>Komponen</th>\n                         </tr>\n                    </thead>\n                    <tbody>\n                        ${n.slice(0,10).map(n=>`\n                            <tr>\n                                <td>${n.worker_name}</td>\n                                <td>${this.formatTime(n.start_time)}</td>\n                                <td><span class="status-badge ${n.status}">${n.status}</span></td>\n                                <td>${n.components_installed}</td>\n                            </tr>\n                        `).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `;e.innerHTML=a}async showAllSessions(){try{this.showLoading();const n=await fetch(`${b}/api/sessions`);if(!n.ok)throw new Error("Failed to load sessions");const e=await n.json();this.displayAllSessions(e),document.getElementById("sessionsModal").classList.remove("hidden")}catch(n){console.error("Error loading sessions:",n),this.showToast("Error loading sessions: "+n.message,"error")}finally{this.hideLoading()}}async resetDatabase(){if(confirm("Adakah anda pasti mahu reset database? Semua data akan hilang dan komponen demo akan dijana semula."))try{if(this.showLoading(),!(await fetch(`${b}/api/reset-db`,{method:"POST"})).ok)throw new Error("Failed to reset database");this.showToast("Database berjaya direset dengan komponen demo yang betul","success"),await this.loadInitialData(),this.currentSession&&this.resetToWorkerSelection()}catch(n){console.error("Error resetting database:",n),this.showToast("Error resetting database: "+n.message,"error")}finally{this.hideLoading()}}displayAllSessions(n){const e=document.getElementById("sessionsContent"),t=`\n            <h3>Semua Sesi Pemasangan (${n.length})</h3>\n            <div class="sessions-table-container">\n                <table class="sessions-table">\n                    <thead>\n                        <tr>\n                            <th>Pekerja</th>\n                            <th>ID Pekerja</th>\n                            <th>Masa Mula</th>\n                            <th>Masa Tamat</th>\n                            <th>Status</th>\n                            <th>Komponen</th>\n                            <th>Ralat</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${n.map(n=>`\n                            <tr>\n                                <td>${n.worker_name}</td>\n                                <td>${n.employee_id}</td>\n                                <td>${this.formatTime(n.start_time)}</td>\n                                <td>${n.end_time?this.formatTime(n.end_time):"-"}</td>\n                                <td><span class="status-badge ${n.status}">${n.status}</span></td>\n                                <td>${n.components_installed}</td>\n                                <td>${n.errors_count}</td>\n                            </tr>\n                        `).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `;e.innerHTML=t}closeModal(n){n.classList.add("hidden")}showLoading(){document.getElementById("loadingOverlay").classList.remove("hidden")}hideLoading(){document.getElementById("loadingOverlay").classList.add("hidden")}showToast(n,e="info"){const t=document.createElement("div");t.className=`toast ${e}`,t.textContent=n,document.getElementById("toastContainer").appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},5e3)}formatTime(n){return n?new Date(n).toLocaleString():"-"}}document.addEventListener("DOMContentLoaded",()=>{new y})})();